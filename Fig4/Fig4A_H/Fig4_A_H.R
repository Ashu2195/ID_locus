A<-read.table("KADK_SILK_WHLH_ID_common_windows_1kb_final.txt",header=T)
B<-read.table("KADK.thetasWindow_1kb.gz.pestPG")
C<-read.table("SILK.thetasWindow_1kb.gz.pestPG")
D<-read.table("WHLH.thetasWindow_1kb.gz.pestPG")
E<-read.table("78_80_phastCons77way.wigFix.bed")
I<-read.table("KADK_SILK_WHLH_dxy_1kb_final.txt",header=T)

tiff(file="Fig_4A_H.tif", res=180,width=4500,height=5000)
scaff<-c("Z")
par(mfrow=c(8,1))
par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],(log(A$sum)), type="l",col="blue",xlim=c(78800000,78850000), ylab =expression("Weighted F"[ST]),cex.lab=4,lwd=6,xlab="",cex.axis=2.5,font.axis=2,bty="n",xaxt='n',ylim=c(-2,6))
abline(h=1.80,col="black",lwd=3,lty=2)
rect(78808957, -1, 78841432, -2, col = "green")
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c(expression(paste("Weighted F"[ST]))),col=c("blue"),cex=2.5,lwd=10,horiz=TRUE, bty="n")
legend("bottomright",legend=c(expression(italic("MTAP"))),col=c("green"),cex=3,lwd=10,horiz=T,bty = "n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_KADK_SILK[A$CHR==scaff], type="l",col="orange",xlim=c(78800000,78850000), ylab =expression(paste("F"[ST])),cex.lab=4,lwd=6,xlab="",cex.axis=2.5,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.835979,col="black", lwd=3,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("KADK Vs SILK"),col=c("orange"),cex=2.5,lwd=10,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_KADK_WHLH[A$CHR==scaff], type="l",col="indianred",xlim=c(78800000,78850000), ylab =expression(paste("F"[ST])),cex.lab=4,lwd=6,xlab="",cex.axis=2.5,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.829057,col="black", lwd=4,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("KADK Vs WHLH"),col=c("indianred"),cex=2.3,lwd=10,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_SILK_WHLH[A$CHR==scaff], type="l",col="green3",xlim=c(78800000,78850000), ylab =expression(paste("F"[ST])),cex.lab=4,lwd=6,xlab="",cex.axis=2.5,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.845818,col="black", lwd=3,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("SILK Vs WHLH"),col=c("green3"),cex=2.5,lwd=10,horiz=TRUE, bty="n")


par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_KADK_SILK[I$scaffold==scaff], type="l",col="orange",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=6,cex.axis=2.5,font.axis=2,font.lab=2,xlim=c(78800000,78850000),bty="n")
abline(h=0.62,col="black", lwd=3,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("KADK Vs SILK"),col=c("orange"),cex=2.5,lwd=10,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_KADK_WHLH[I$scaffold==scaff], type="l",col="indianred",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=6,cex.axis=2.5,font.axis=2,font.lab=2,xlim=c(78800000,78850000),bty="n")
abline(h=0.5639,col="black", lwd=3,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("KADK Vs WHLH"),col=c("indianred"),cex=2.5,lwd=10,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_SILK_WHLH[I$scaffold==scaff], type="l",col="green3",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=6,cex.axis=2.5,font.axis=2,font.lab=2,xlim=c(78800000,78850000),bty="n")
abline(h=0.625,col="black", lwd=3,lty=2)
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
legend("topleft",legend=c("SILK Vs WHLH"),col=c("green3"),cex=2.5,lwd=10,horiz=TRUE, bty="n")

par(mar=c(6,20,4,10), mgp=c(10,4,1))
plot(E$V2,E$V5,type="l",xlim=c(78800000,78850000),xlab=c(expression(paste(bold("Position along chromosome Z")))), ylab=c(expression(paste(bold("phastCons score")))),col="darkblue", cex.lab=3, cex.axis=2.5, font.axis=2,lwd=3,bty="n")
abline(v=78837000,col="red",lwd = 3, lty = 2) 
abline(v=78842000,col="red",lwd = 3, lty = 2)
dev.off()
