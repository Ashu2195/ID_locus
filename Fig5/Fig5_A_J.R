A<-read.table("KADK_SILK_WHLH_ID_common_windows_1kb_final.txt",header=T)
B<-read.table("KADK.thetasWindow_1kb.gz.pestPG")
C<-read.table("SILK.thetasWindow_1kb.gz.pestPG")
D<-read.table("WHLH.thetasWindow_1kb.gz.pestPG")
E<-read.table("Chr_Z_72_73_phastCons77way.wigFix.bed")
I<-read.table("KADK_SILK_WHLH_dxy_1kb_final.txt",header=T)

tiff(file="FIG5_A_J.tif", res=220,width=7000,height=9000)
scaff<-c("Z")
par(mfrow=c(10,1))
par(mar=c(2,20,10,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],(log(A$sum)), type="l",col="blue",xlim=c(72560000,72625000), ylab =expression(paste("Weighted F"[ST])),cex.lab=4,lwd=8,xlab="",cex.axis=3,font.axis=2,font.lab=2,bty="n",xaxt='n',ylim=c(-1.5,5))
abline(h=1.80,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 3, lty = 2) 
abline(v=72606000,col="red",lwd = 3, lty = 2)
rect(72589753,-2,72589844,1,col="cyan4")
rect(72590401,-2,72590512,1,col="purple3")	 
legend("topright",legend=c(expression(paste("Weighted F"[ST]))),col=c("blue"),cex=4,lwd=20,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_KADK_SILK[A$CHR==scaff], type="l",col="orange",xlim=c(72560000,72625000), ylab =expression(paste("F"[ST])),cex.lab=5,lwd=8,xlab="",cex.axis=3,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.835979,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 3, lty = 2) 
abline(v=72606000,col="red",lwd = 3, lty = 2)
legend(x=72616000, y = 1.15,legend=c("KADK Vs SILK"),col=c("orange"),cex=4,lwd=20,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_KADK_WHLH[A$CHR==scaff], type="l",col="indianred",xlim=c(72560000,72625000), ylab =expression(paste("F"[ST])),cex.lab=5,lwd=8,xlab="",cex.axis=3,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.829057,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend(x=72615000, y = 1.15,legend=c("KADK Vs WHLH"),col=c("indianred"),cex=4,lwd=20,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(A$BP[A$CHR==scaff],A$FST_SILK_WHLH[A$CHR==scaff], type="l",col="green3",xlim=c(72560000,72625000), ylab =expression(paste("F"[ST])),cex.lab=5,lwd=8,xlab="",cex.axis=3,font.axis=2,font.lab=2,bty="n",xaxt='n')
abline(h=0.845818,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend(x=72616000, y = 1.15,legend=c("SILK Vs WHLH"),col=c("green3"),cex=4,lwd=20,horiz=TRUE, bty="n")


par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_KADK_SILK[I$scaffold==scaff], type="l",col="orange",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=8,cex.axis=3,font.axis=2,font.lab=2,xlim=c(72560000,72625000),bty="n")
abline(h=0.62,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend("topright",legend=c("KADK Vs SILK"),col=c("orange"),cex=4,lwd=20,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_KADK_WHLH[I$scaffold==scaff], type="l",col="indianred",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=8,cex.axis=3,font.axis=2,font.lab=2,xlim=c(72560000,72625000),bty="n")
abline(h=0.5639,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend("topright",legend=c("KADK Vs WHLH"),col=c("indianred"),cex=4,lwd=20,horiz=TRUE, bty="n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(I$start[I$scaffold==scaff],I$dxy_SILK_WHLH[I$scaffold==scaff], type="l",col="green3",ylab=expression("D"[xy]),cex.lab=5,xlab="",xaxt='n',lwd=8,cex.axis=3,font.axis=2,font.lab=2,xlim=c(72560000,72625000),bty="n")
abline(h=0.625,col="black", lwd=4,lty=2)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend("topright",legend=c("SILK Vs WHLH"),col=c("green3"),cex=4,lwd=20,horiz=TRUE, bty="n")


par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(B$V3[B$V2==scaff],B$V5[B$V2==scaff]/B$V14[B$V2==scaff], type="l",col="slateblue2", ylab = expression(paste(bold(pi))),cex.lab=4,lwd=8,xlab="",xaxt='n',cex.axis=3,ylim=c(0,0.007),font.axis=2,font.lab=2,xlim=c(72560000,72625000),bty="n")
lines(C$V3[C$V2==scaff],C$V5[C$V2==scaff]/C$V14[C$V2==scaff], type="l",col="firebrick1",lwd=8)
lines(D$V3[D$V2==scaff],D$V5[D$V2==scaff]/D$V14[D$V2==scaff], type="l",col="cyan4",lwd=8)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend("topright",legend=c("KADK","SILK","WHLH"),col=c("slateblue2","firebrick1","cyan4"),cex=3.5,lwd=20,horiz=TRUE,bty = "n")

par(mar=c(2,20,2,10), mgp=c(10,4,1))
plot(B$V3[B$V2==scaff],B$V4[B$V2==scaff]/B$V14[B$V2==scaff], type="l",col="slateblue2", ylab = expression(paste(bold(theta["W"]))),cex.lab=5,lwd=8,xlab="",xaxt='n',cex.axis=3,ylim=c(0,0.005),font.axis=2,font.lab=2,xlim=c(72560000,72625000),bty="n")
lines(C$V3[C$V2==scaff],C$V4[C$V2==scaff]/C$V14[C$V2==scaff], type="l",col="firebrick1",lwd=8)
lines(D$V3[D$V2==scaff],D$V4[D$V2==scaff]/D$V14[D$V2==scaff], type="l",col="cyan4",lwd=8)
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2)
legend("topright",legend=c("KADK","SILK","WHLH"),col=c("slateblue2","firebrick1","cyan4"),cex=3.5,lwd=20,horiz=TRUE,bty = "n")

par(mar=c(6,20,4,10), mgp=c(10,4,1))
plot(E$V2,E$V5,type="l",xlim=c(72560000,72625000),xlab=c(expression(paste(bold("Position along chromosome Z")))), ylab=c(expression(paste(bold("phastCons score")))),col="darkblue", cex.lab=4, cex.axis=3, font.axis=2,lwd=4,bty="n")
rect(72589753, -100,72589844 ,100, cex=1, col=rgb(0.7,0.6,0.1,alpha=0.2),lwd=8,bty="n",border="transparent")
rect(72590401, -100,72590512 ,100, cex=1, col=rgb(0.7,0.6,0.1,alpha=0.2),lwd=8,bty="n",border="transparent")
abline(v=72580000,col="red",lwd = 4, lty = 2) 
abline(v=72606000,col="red",lwd = 4, lty = 2) 
dev.off()
